#This file written by /home/con/DNA_Methylation/Public_data/make_RRBS_commands.pl
library(methylKit)
file.list = list("/home/con/DNA_Methylation/Public_data/R/BL01_artif.chr10.RRBS_background.1_DMR.class.1.bsmooth.tsv","/home/con/DNA_Methylation/Public_data/R/BL02_artif.chr10.RRBS_background.1_DMR.class.1.bsmooth.tsv","/home/con/DNA_Methylation/Public_data/R/BL03_artif.chr10.RRBS_background.1_DMR.class.1.bsmooth.tsv","/home/con/DNA_Methylation/Public_data/R/BL04_artif.chr10.RRBS_background.1_DMR.class.1.bsmooth.tsv","/home/con/DNA_Methylation/Public_data/R/BL05_artif.chr10.RRBS_background.1_DMR.class.1.bsmooth.tsv","/home/con/DNA_Methylation/Public_data/R/BL06_artif.chr10.RRBS_background.1_DMR.class.1.bsmooth.tsv","/home/con/DNA_Methylation/Public_data/R/BL07_artif.chr10.RRBS_background.1_DMR.class.1.bsmooth.tsv","/home/con/DNA_Methylation/Public_data/R/BL08_artif.chr10.RRBS_background.1_DMR.class.1.bsmooth.tsv","/home/con/DNA_Methylation/Public_data/R/BL09_artif.chr10.RRBS_background.1_DMR.class.1.bsmooth.tsv","/home/con/DNA_Methylation/Public_data/R/BL10_artif.chr10.RRBS_background.1_DMR.class.1.bsmooth.tsv","/home/con/DNA_Methylation/Public_data/R/FL01_artif.chr10.RRBS_background.1_DMR.class.1.bsmooth.tsv","/home/con/DNA_Methylation/Public_data/R/FL02_artif.chr10.RRBS_background.1_DMR.class.1.bsmooth.tsv","/home/con/DNA_Methylation/Public_data/R/FL03_artif.chr10.RRBS_background.1_DMR.class.1.bsmooth.tsv","/home/con/DNA_Methylation/Public_data/R/FL04_artif.chr10.RRBS_background.1_DMR.class.1.bsmooth.tsv","/home/con/DNA_Methylation/Public_data/R/FL05_artif.chr10.RRBS_background.1_DMR.class.1.bsmooth.tsv","/home/con/DNA_Methylation/Public_data/R/FL06_artif.chr10.RRBS_background.1_DMR.class.1.bsmooth.tsv","/home/con/DNA_Methylation/Public_data/R/FL07_artif.chr10.RRBS_background.1_DMR.class.1.bsmooth.tsv","/home/con/DNA_Methylation/Public_data/R/FL08_artif.chr10.RRBS_background.1_DMR.class.1.bsmooth.tsv","/home/con/DNA_Methylation/Public_data/R/FL09_artif.chr10.RRBS_background.1_DMR.class.1.bsmooth.tsv","/home/con/DNA_Methylation/Public_data/R/FL10_artif.chr10.RRBS_background.1_DMR.class.1.bsmooth.tsv")
myobj=methRead( file.list, sample.id=list('B1','B2','B3','B4','B5','B6','B7','B8','B9','B10','F1','F2','F3','F4','F5','F6','F7','F8','F9','F10'),assembly='mm9',treatment=c(0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1),header=TRUE)
filtered.myobj <- filterByCoverage(myobj, lo.count = 10,lo.perc = NULL, hi.count = NULL)
rm(myobj)
tiles <- tileMethylCounts(filtered.myobj, win.size = 1000, step.size = 1000)
meth=unite(tiles,destrand=FALSE)
myDiff=calculateDiffMeth(meth, num.cores=1)
write.table(myDiff, file = "1.1.methylKit.tile.answers.RRBS.tsv", sep="\t", quote = FALSE, col.names = TRUE, row.names = FALSE)
